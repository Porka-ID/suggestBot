'use strict';

var pieces = require('@sapphire/pieces');
var Listener_js = require('../../../lib/structures/Listener.js');
var Events_js = require('../../../lib/types/Events.js');

var __defProp = Object.defineProperty;
var __name = (target, value) => __defProp(target, "name", { value, configurable: true });
var _CoreListener = class _CoreListener extends Listener_js.Listener {
  constructor(context) {
    super(context, { event: Events_js.Events.PreContextMenuCommandRun });
  }
  async run(payload) {
    const { command, interaction } = payload;
    const globalResult = await this.container.stores.get("preconditions").contextMenuRun(interaction, command, payload);
    if (globalResult.isErr()) {
      this.container.client.emit(Events_js.Events.ContextMenuCommandDenied, globalResult.unwrapErr(), payload);
      return;
    }
    const localResult = await command.preconditions.contextMenuRun(interaction, command, payload);
    if (localResult.isErr()) {
      this.container.client.emit(Events_js.Events.ContextMenuCommandDenied, localResult.unwrapErr(), payload);
      return;
    }
    this.container.client.emit(Events_js.Events.ContextMenuCommandAccepted, payload);
  }
};
__name(_CoreListener, "CoreListener");
var CoreListener = _CoreListener;
void pieces.container.stores.loadPiece({
  name: "CorePreContextMenuCommandRun",
  piece: CoreListener,
  store: "listeners"
});

exports.CoreListener = CoreListener;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=CorePreContextMenuCommandRun.js.map